<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GIÁ VÀNG</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            margin: 0;
            padding: 15px;
            color: #333;
            line-height: 1.5;
            max-width: 1000px;
            margin: 0 auto;
        }

        h1 {
            font-size: 24px;
            margin-bottom: 5px;
            color: #000;
            font-weight: bold;
            border-bottom: 1px solid #e0e0e0;
            padding-bottom: 8px;
        }

        .nguon {
            font-style: italic;
            font-size: 13px;
            color: #666;
            margin-bottom: 15px;
            display: block;
        }

        h2 {
            font-size: 18px;
            margin: 20px 0 10px 0;
            color: #000;
            font-weight: bold;
        }

        .ngay {
            font-weight: bold;
            margin: 10px 0;
            font-size: 14px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 10px 0 15px 0;
            font-size: 14px;
        }

        th,
        td {
            border: 1px solid #ddd;
            padding: 8px 5px;
            text-align: center;
        }

        th {
            background-color: #f5f5f5;
            font-weight: bold;
        }

        .donvi {
            font-size: 13px;
            color: #666;
            margin: 5px 0;
        }

        .tanggiam {
            font-size: 13px;
            color: #666;
            font-style: italic;
            margin-bottom: 15px;
        }

        hr {
            border: 0;
            height: 1px;
            background-color: #e0e0e0;
            margin: 20px 0;
        }

        .bieudo-title {
            font-weight: bold;
            margin: 15px 0 5px 0;
            font-size: 14px;
        }

        .chart-container {
            position: relative;
            height: 300px;
            margin: 15px 0;
        }

        .gold-type-selector {
            margin: 15px 0;
        }

        select {
            padding: 8px 12px;
            border-radius: 4px;
            border: 1px solid #ddd;
            font-size: 14px;
        }
    </style>
</head>

<body>
    <h1>GIÁ VÀNG</h1>
    <span class="nguon">Nguồn: giavang.net và pnj.com.vn - Cập nhật lúc 12:48 (25/05/2025)</span>

    <h2>Tìm mã vàng nhanh</h2>
    <div class="ngay">2025-05-25</div>

    <table id="goldTable">
        <tr>
            <th rowspan="2"></th>
            <th colspan="2">Hôm nay (25/05/2025)</th>
            <th colspan="2">Hôm qua (24/05/2025)</th>
        </tr>
        <tr>
            <th>Giá mua</th>
            <th>Giá bán</th>
            <th>Giá mua</th>
            <th>Giá bán</th>
        </tr>
        <!-- Table content will be generated by JavaScript -->
    </table>

    <div class="donvi">Đơn vị: nghìn đồng/lượng</div>
    <div class="tanggiam">*Tăng giảm so sánh với ngày trước đó</div>

    <hr>

    <h2>Biểu đồ giá vàng 30 ngày gần nhất</h2>

    <div class="gold-type-selector">
        <label for="goldType"></label>
        <select id="goldType">
            <option value="SJC">SJC</option>
            <option value="DOJI HN">DOJI HN</option>
            <option value="DOJI SG">DOJI SG</option>
            <option value="BTMC SJC">BTMC SJC</option>
            <option value="PHÚ QUY SJC">PHÚ QUY SJC</option>
            <option value="PNJ TP.HCM">PNJ TP.HCM</option>
            <option value="PNJ HÀ NỘI">PNJ HÀ NỘI</option>
        </select>
    </div>

    <div class="bieudo-title" id="chartTitle">SJC</div>

    <div class="chart-container">
        <canvas id="goldChart"></canvas>
    </div>

    <script>
        // Mock data cho các loại vàng
        const goldData = {
            "SJC": {
                todayBuy: 119000,
                todaySell: 121000,
                yesterdayBuy: 119000,
                yesterdaySell: 121000,
                baseBuy: 119000,
                baseSell: 121000,
                fluctuation: 3000
            },
            "DOJI HN": {
                todayBuy: 118500,
                todaySell: 120500,
                yesterdayBuy: 118500,
                yesterdaySell: 120500,
                baseBuy: 118500,
                baseSell: 120500,
                fluctuation: 2800
            },
            "DOJI SG": {
                todayBuy: 118700,
                todaySell: 120700,
                yesterdayBuy: 118700,
                yesterdaySell: 120700,
                baseBuy: 118700,
                baseSell: 120700,
                fluctuation: 2900
            },
            "BTMC SJC": {
                todayBuy: 119200,
                todaySell: 121200,
                yesterdayBuy: 119200,
                yesterdaySell: 121200,
                baseBuy: 119200,
                baseSell: 121200,
                fluctuation: 3100
            },
            "PHÚ QUY SJC": {
                todayBuy: 118000,
                todaySell: 121000,
                yesterdayBuy: 118000,
                yesterdaySell: 121000,
                baseBuy: 118000,
                baseSell: 121000,
                fluctuation: 3200
            },
            "PNJ TP.HCM": {
                todayBuy: 113000,
                todaySell: 116000,
                yesterdayBuy: 113000,
                yesterdaySell: 116000,
                baseBuy: 113000,
                baseSell: 116000,
                fluctuation: 2000
            },
            "PNJ HÀ NỘI": {
                todayBuy: 113500,
                todaySell: 116500,
                yesterdayBuy: 113500,
                yesterdaySell: 116500,
                baseBuy: 113500,
                baseSell: 116500,
                fluctuation: 2100
            }
        };

        // Tạo dữ liệu ngẫu nhiên cho biểu đồ 30 ngày
        function generateRandomData(baseValue, fluctuation) {
            let data = [];
            for (let i = 0; i < 30; i++) {
                data.push(baseValue + Math.random() * fluctuation - fluctuation / 2);
            }
            return data.map(value => Math.round(value / 1000) * 1000); // Làm tròn đến nghìn đồng
        }

        // Tạo dữ liệu cho bảng
        function generateTableData() {
            const table = document.getElementById('goldTable');
            // Xóa các hàng hiện có (trừ 2 hàng tiêu đề)
            while (table.rows.length > 2) {
                table.deleteRow(2);
            }

            // Thêm dữ liệu cho từng loại vàng
            for (const [goldType, data] of Object.entries(goldData)) {
                const row = table.insertRow();
                const cell1 = row.insertCell(0);
                cell1.textContent = goldType;

                const cell2 = row.insertCell(1);
                cell2.textContent = data.todayBuy.toLocaleString('vi-VN');

                const cell3 = row.insertCell(2);
                cell3.textContent = data.todaySell.toLocaleString('vi-VN');

                const cell4 = row.insertCell(3);
                cell4.textContent = data.yesterdayBuy.toLocaleString('vi-VN');

                const cell5 = row.insertCell(4);
                cell5.textContent = data.yesterdaySell.toLocaleString('vi-VN');
            }
        }

        // Khởi tạo biểu đồ
        let goldChart;
        function initChart(goldType) {
            const data = goldData[goldType];

            // Tạo dữ liệu mua vào và bán ra 30 ngày
            const dates = [];
            for (let i = 29; i >= 0; i--) {
                const date = new Date();
                date.setDate(date.getDate() - i);
                dates.push(`${date.getDate()}/${date.getMonth() + 1}`);
            }

            const muaVaoData = generateRandomData(data.baseBuy, data.fluctuation);
            const banRaData = generateRandomData(data.baseSell, data.fluctuation);

            // Lấy context của canvas
            const ctx = document.getElementById('goldChart').getContext('2d');

            // Nếu biểu đồ đã tồn tại, hủy nó trước khi tạo mới
            if (goldChart) {
                goldChart.destroy();
            }

            // Vẽ biểu đồ mới
            goldChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: dates,
                    datasets: [
                        {
                            label: 'Mua vào',
                            data: muaVaoData,
                            borderColor: 'rgb(241, 54, 40)',
                            backgroundColor: 'rgba(241, 54, 40, 0.1)',
                            borderWidth: 1.5,
                            tension: 0.1,
                            pointStyle: 'circle', // Hinh tròn
                            pointRadius: 3,
                            pointBackgroundColor: 'rgb(241, 54, 40)'
                        },
                        {
                            label: 'Bán ra',
                            data: banRaData,
                            borderColor: 'rgb(37, 138, 41)',
                            backgroundColor: 'rgba(54, 162, 235, 0.1)',
                            borderWidth: 1.5,
                            tension: 0.1,
                            pointStyle: 'rectRot', // Hình thoi
                            pointRadius: 3,
                            pointBackgroundColor: 'rgb(37, 138, 41)',
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'top',
                        },
                        tooltip: {
                            callbacks: {
                                title: function (context) {
                                    return `Ngày ${context[0].label}`;
                                },
                                label: function (context) {
                                    return `${context.dataset.label}: ${context.parsed.y.toLocaleString('vi-VN')} đ`;
                                }
                            }
                        }
                    },
                    scales: {
                        x: {
                            title: {
                                display: true,
                                text: 'Ngày'
                            },
                            grid: {
                                display: false
                            },
                            ticks: {
                                callback: function (value, index, ticks) {
                                    // Chỉ hiển thị nhãn mỗi 5 ngày
                                    return (29 - index) % 2 === 0 ? this.getLabelForValue(value) : '';
                                }
                            }
                        },
                        y: {
                            beginAtZero: false,
                            grid: {
                                display: true,
                            },
                            ticks: {
                                callback: function (value) {
                                    return value.toLocaleString('vi-VN') + 'đ';
                                }
                            },
                            suggestedMin: Math.min(...muaVaoData, ...banRaData) - 1000,
                            suggestedMax: Math.max(...muaVaoData, ...banRaData) + 1000
                        }
                    }
                }
            });
        }

        // Xử lý sự kiện khi chọn loại vàng
        document.getElementById('goldType').addEventListener('change', function () {
            const selectedGoldType = this.value;
            document.getElementById('chartTitle').textContent = selectedGoldType;
            initChart(selectedGoldType);
        });

        // Khởi tạo trang
        window.onload = function () {
            generateTableData();
            initChart('SJC');
        };
    </script>
</body>

</html>